#!/bin/bash

echo "üß™ Testing Google Authentication - Updated Setup"
echo "================================================"
echo ""

# Test current Flutter app
echo "üåê Current Flutter App Status:"
if curl -s http://localhost:3001 > /dev/null; then
    echo "‚úÖ Flutter app running on http://localhost:3001"
else
    echo "‚ùå Flutter app not running on localhost:3001"
fi

echo ""
echo "üîß Required Supabase Dashboard Configuration:"
echo "1. Go to: https://supabase.com/dashboard/project/xxasezacvotitccxnpaa"
echo "2. Navigate to: Authentication ‚Üí Providers ‚Üí Google"
echo "3. Enable Google provider and add:"
echo "   - Client ID: 631111437135-iuippmjn73ur1g4thacjmr5lq3k315t0.apps.googleusercontent.com"
echo "   - Client Secret: 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"
echo ""
echo "4. Navigate to: Authentication ‚Üí URL Configuration"
echo "5. Add these redirect URLs:"
echo "   - http://localhost:3001"
echo "   - http://localhost:3000"
echo "   - http://localhost:8080"
echo "   - http://127.0.0.1:3001"
echo "   - http://127.0.0.1:3000"
echo "   - https://xxasezacvotitccxnpaa.supabase.co/auth/v1/callback"
echo ""
echo "üîß Required Google Cloud Console Configuration:"
echo "1. Go to: https://console.cloud.google.com/apis/credentials"
echo "2. Find your OAuth 2.0 Client (Web): 631111437135-iuippmjn73ur1g4thacjmr5lq3k315t0"
echo "3. Add these Authorized JavaScript origins:"
echo "   - http://localhost:3001"
echo "   - http://localhost:3000"
echo "   - http://localhost:8080"
echo "   - http://127.0.0.1:3001"
echo "   - http://127.0.0.1:3000"
echo "   - https://xxasezacvotitccxnpaa.supabase.co"
echo ""
echo "4. Add these Authorized redirect URIs:"
echo "   - https://xxasezacvotitccxnpaa.supabase.co/auth/v1/callback"
echo "   - http://localhost:3001"
echo "   - http://localhost:3000"
echo ""
echo "üß™ How to Test:"
echo "1. Complete the configuration above"
echo "2. Open: http://localhost:3001"
echo "3. Click 'Sign in with Google'"
echo "4. Should redirect to Google OAuth consent screen"
echo "5. Grant permissions and return to app"
echo "6. Should be signed in successfully"
echo ""
echo "üö® Common Issues & Solutions:"
echo "‚Ä¢ 'Invalid redirect_uri': Add all localhost URLs to Google Console"
echo "‚Ä¢ 'Unauthorized domain': Add origins to Google Console"
echo "‚Ä¢ 'Configuration error': Check client ID/secret in Supabase"
echo "‚Ä¢ Popup blocked: Allow popups for localhost"
echo ""
echo "üì± For Mobile Testing:"
echo "‚Ä¢ Android: Check SHA-1 fingerprint registration"
echo "‚Ä¢ iOS: Verify iOS client ID in app configuration"
echo ""
echo "üîó Direct Links:"
echo "‚Ä¢ Test App: http://localhost:3001"
echo "‚Ä¢ Supabase: https://supabase.com/dashboard/project/xxasezacvotitccxnpaa"
echo "‚Ä¢ Google Console: https://console.cloud.google.com/apis/credentials"
